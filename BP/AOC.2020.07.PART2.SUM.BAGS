SUBROUTINE SUM.BAGS(THIS.BAG, TOTAL.COUNT)
COMMON /AOC.2020.07/ F.BAGS

TOTAL.COUNT = 1

READ R.BAG FROM F.BAGS, THIS.BAG THEN
  N.CONTAINS = DCOUNT(R.BAG<2>, @VM)
  FOR X = 1 TO N.CONTAINS
    THIS.COUNT = 0
    CALL AOC.2020.07.PART2.SUM.BAGS(R.BAG<3,X>, THIS.COUNT)
    TOTAL.COUNT += THIS.COUNT * R.BAG<2,X>
  NEXT
END
